# count = 3014387
# # count = 5
#
# power = 0
# while 2**power <= count
#   power += 1
# end
# result = 2**(power - 1)
#
# p (count - result) * 2 + 1


count = 3014387
# count = 99
offset = 0
list = count.times.to_a
while list.length > 1
  p list.length if list.length % 1000 == 0
  rotate = list.length / 2
  if offset + rotate >= list.length
    list.rotate!(offset)
    offset = 0
  end
  list.delete_at(rotate + offset)
  offset += 1
end
p [count, list.first]


<<-eos

1 => 0
2 => 0
3 => 2
4 => 0
5 => 1
6 => 2
7 => 4
8 => 6
9 => 8
10 => 0
11 => 1
12 => 2
!13 => 4
!14 => 6
!15 => 8
16 => 6


0 => 2, 1 => 3, 0 => 1
0 => 2, 1 => 4, 3 => 0, 1 => 3
0 => 3, 1 => 4, 2 => 0, 5 => 1, 2 => 5
0 => 3, 1 => 5, 2 => 6, 4 => 1, 0 => 2, 4 => 0
0 => 4, 1 => 5, 2 => 7, 3 => 0, 6 => 2, 1 => 3, 6 => 1
0 => 4, 1 => 6, 2 => 7, 3 => 0, 5 => 1, 8 => 3, 2 => 5, 8 => 2
0 => 5, 1 => 6, 2 => 8, 3 => 9, 4 => 1, 7 => 2, 0 => 4, 3 => 7, 0 => 3
0 => 5, 1 => 7, 2 => 8, 3 => 10, 4 => 0, 6 => 2, 9 => 3, 1 => 6, 4 => 9, 1 => 4
0 => 6, 1 => 7, 2 => 9, 3 => 10, 4 => 0, 5 => 1, 8 => 3, 11 => 4, 2 => 8, 5 => 11, 2 => 5


0 => 8, 1 => 9, 2 => 11, 3 => 12, 4 => 14, 5 => 15, 6 => 1, 7 => 2, 10 => 4, 13 => 5, 0 => 7, 3 => 10, 6 => 0, 13 => 3, 6 => 13

0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15
0 1 2 3 4 5 6 7 9 10 11 12 13 14 15
0 1 2 3 4 5 6 7 10 11 12 13 14 15
0 1 2 3 4 5 6 7 10 12 13 14 15
0 1 2 3 4 5 6 7 10 13 14 15
0 1 2 3 4 5 6 7 10 13 15
0 1 2 3 4 5 6 7 10 13
0 2 3 4 5 6 7 10 13
0 3 4 5 6 7 10 13
0 3 5 6 7 10 13
0 3 6 7 10 13
0 3 6 10 13
0 3 6 13












0 1 2 3 4 5 6 7 8
0 2 4 6 8
2 6
2



0 1 2 3 4 5 6 7 8 9 10
0 2 4 6 8 10
2 6 10
6


1 => 0
2 => 0
3 => 2
4 => 0
5 => 2
6 => 4
7 => 6
8 => 0
9 => 2
10 => 4
11 => 6
12 => 8
13 => 10
14 => 12
15 => 14
16 => 0


0 => 1
0 => 1, 2 => 0
0 => 1, 2 => 3, 0 => 2
0 => 1, 2 => 3, 4 => 0, 2 => 4
0 => 1, 2 => 3, 4 => 5, 0 => 2, 4 => 0
0 => 1, 2 => 3, 4 => 5, 6 => 0, 2 => 4, 6 => 2
0 => 1, 2 => 3, 4 => 5, 6 => 7, 0 => 2, 4 => 6, 0 => 4
0 => 1, 2 => 3, 4 => 5, 6 => 7, 8 => 0, 2 => 4, 6 => 8, 2 => 6
0 => 1, 2 => 3, 4 => 5, 6 => 7, 8 => 9, 0 => 2, 4 => 6, 8 => 0, 4 => 8

0 => 1, 2 => 3, 4 => 5, 6 => 7, 8 => 9, 10 => 11, 0 => 2, 4 => 6, 8 => 10, 0 => 4, 8 => 0
0 => 1, 2 => 3, 4 => 5, 6 => 7, 8 => 9, 10 => 11, 12 => 0, 2 => 4, 6 => 8, 10 => 12, 2 => 6, 10 => 2
0 => 1, 2 => 3, 4 => 5, 6 => 7, 8 => 9, 10 => 11, 12 => 13, 0 => 2, 4 => 6, 8 => 10, 12 => 0, 4 => 8, 12 => 4
0 => 1, 2 => 3, 4 => 5, 6 => 7, 8 => 9, 10 => 11, 12 => 13, 14 => 0, 2 => 4, 6 => 8, 10 => 12, 14 => 2, 6 => 10, 14 => 6
0 => 1, 2 => 3, 4 => 5, 6 => 7, 8 => 9, 10 => 11, 12 => 13, 14 => 15, 0 => 2, 4 => 6, 8 => 10, 12 => 14, 0 => 4, 8 => 12, 0 => 8

eos
